CardioAI
========
Веб-приложение-чат-бот для первичного анализа записи сердечного ритма (SCG/ECG).  
Бэкенд — FastAPI, LLM-клиент — WriterAI, фронтенд — React + Vite.

──────────────────────────────────────────────────────────────────────────────
1. Структура репозитория
──────────────────────────────────────────────────────────────────────────────
cardioai/
│
├── server.py          ── FastAPI-роуты (/api/init, /api/chat)
├── controller.py      ── слой Controller (логика диалога)
├── chat_model.py      ── WriterChatSession (обёртка LLM)
├── utils.py           ── вспомогательные функции
├── config.ini         ── SYSTEM_PROMPT и прочие настройки
├── requirements.txt
│
└── frontend/          ── React-SPA
    ├── vite.config.js ── proxy на бекенд
    ├── src/
    │   ├── App.jsx
    │   └── main.jsx
    └── package.json

──────────────────────────────────────────────────────────────────────────────
2. Требования
──────────────────────────────────────────────────────────────────────────────
Python ≥ 3.9  
Node.js ≥ 18 (npm идёт в комплекте)  
WriterAI API Key

──────────────────────────────────────────────────────────────────────────────
3. Переменные окружения
──────────────────────────────────────────────────────────────────────────────
Создайте файл `.env` в корневой директории:

WRITER_API_KEY="YOUR_WRITER_KEY"

Файл автоматически загружается (python-dotenv) либо передаётся
в uvicorn через флаг `--env-file`.

──────────────────────────────────────────────────────────────────────────────
4. Быстрый запуск (режим разработки)
──────────────────────────────────────────────────────────────────────────────
# 4.1  Backend
python -m venv .venv && source .venv/bin/activate       # Windows: .venv\Scripts\activate
pip install -r requirements.txt
uvicorn server:app --reload --env-file .env             # http://localhost:8000

# 4.2  Frontend
cd frontend
npm install
npm run dev                                             # http://localhost:5173

В `frontend/vite.config.js` уже настроен proxy, поэтому любые запросы
к `/api/*` автоматически перенаправляются на порт 8000.

──────────────────────────────────────────────────────────────────────────────
5. Сборка production-версии
──────────────────────────────────────────────────────────────────────────────
cd frontend
npm run build           # результат в frontend/dist
cd ..
uvicorn server:app --host 0.0.0.0 --port 8000 --env-file .env

(Статические файлы dist/ можно обслуживать nginx или StaticFiles FastAPI.)

──────────────────────────────────────────────────────────────────────────────
6. Архитектура MVC
──────────────────────────────────────────────────────────────────────────────
Model      →  WriterChatSession (chat_model.py)  
Controller  →  Controller (controller.py)  
View        →  React-SPA (frontend/src)

REST-эндпоинты:

POST /api/init   — передаёт наблюдение, возвращает первый ответ модели  
POST /api/chat   — отправляет пользовательское сообщение, получает ответ

──────────────────────────────────────────────────────────────────────────────
7. Лицензия
──────────────────────────────────────────────────────────────────────────────
MIT — см. файл LICENSE
